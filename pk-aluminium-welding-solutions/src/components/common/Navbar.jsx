import React from 'react';
import { Link as RouterLink, useLocation } from 'react-router-dom';
import {
Â  Box,
Â  Flex,
Â  HStack,
Â  IconButton,
Â  Link,
Â  useDisclosure,
Â  useColorModeValue,
Â  Stack,
Â  Button,
Â  Text,
Â  Icon,
Â  Image as ChakraImage, // ðŸ‘ˆ FIX: Alias the Chakra Image component
} from '@chakra-ui/react';
import { HamburgerIcon, CloseIcon } from '@chakra-ui/icons';
import { motion } from 'framer-motion';
import { FaPhoneAlt } from 'react-icons/fa';

// Assuming COMPANY constants are defined elsewhere
const COMPANY = {
Â  Â  phone: '021 555 1234',
Â  Â  phoneRaw: '+27215551234',
Â  Â  whatsappLink: 'https://wa.me/27821234567',
};

// --- Framer Motion Components ---
const MotionBox = motion.create(Box);
const MotionFlex = motion.create(Flex);
const MotionLink = motion.create(Link);
const MotionButton = motion.create(Button);

// --- Navigation Links ---
const Links = [
Â  { to: '/', label: 'Home' },
Â  { to: '/about', label: 'About' },
Â  { to: '/services', label: 'Services' },
Â  { to: '/faq', label: 'FAQ' },
Â  { to: '/contact', label: 'Contact' },];

// --- NavLink Component (Enhanced with Animation and Styling) ---
function NavLink({ to, children }) {
Â  const location = useLocation();
Â  const isActive = location.pathname === to;
Â  const linkColor = useColorModeValue('gray.600', 'gray.300');
Â  const activeColor = useColorModeValue('blue.700', 'blue.300');
Â  const underlineColor = useColorModeValue('blue.500', 'blue.400');

Â  return (
Â  Â  <MotionLink
Â  Â  Â  as={RouterLink}
Â  Â  Â  px={3}
Â  Â  Â  py={2}
Â  Â  Â  rounded={'sm'}
Â  Â  Â  to={to}
Â  Â  Â  fontWeight={isActive ? 'bold' : 'medium'}
Â  Â  Â  color={isActive ? activeColor : linkColor}
Â  Â  Â  position="relative"
Â  Â  Â  overflow="hidden"
Â  Â  Â  whileHover={{ y: -2 }} 
Â  Â  Â  transition={{ duration: 0.15 }}
Â  Â  Â  _hover={{ textDecoration: 'none', color: activeColor }}
Â  Â  >
Â  Â  Â  {children}
Â  Â  Â  {/* Animated Underline Indicator */}
Â  Â  Â  {isActive && (
Â  Â  Â  Â  <MotionBox
Â  Â  Â  Â  Â  position="absolute"
Â  Â  Â  Â  Â  bottom="0"
Â  Â  Â  Â  Â  left="0"
Â  Â  Â  Â  Â  right="0"
Â  Â  Â  Â  Â  h="2px"
Â  Â  Â  Â  Â  bg={underlineColor}
Â  Â  Â  Â  Â  layoutId="nav-underline"
Â  Â  Â  Â  Â  transition={{ type: 'spring', stiffness: 500, damping: 30 }}
Â  Â  Â  Â  />
Â  Â  Â  )}
Â  Â  </MotionLink>
Â  );
}

// --- Main Navbar Component ---
export default function Navbar() {
Â  const { isOpen, onOpen, onClose } = useDisclosure();
Â  const bg = useColorModeValue('white', 'gray.900');
Â  const border = useColorModeValue('gray.100', 'gray.700');
Â  const accentColor = useColorModeValue('blue.600', 'blue.400');

Â  const navbarVariants = {
Â  Â  initial: { y: -50, opacity: 0 },
Â  Â  animate: { y: 0, opacity: 1, transition: { type: 'spring', stiffness: 100, delay: 0.1 } },
Â  };

Â  return (
Â  Â  <MotionBox
Â  Â  Â  bg={bg}
Â  Â  Â  px={4}
Â  Â  Â  borderBottomWidth="1px"
Â  Â  Â  borderColor={border}
Â  Â  Â  position="sticky"
Â  Â  Â  top="0"
Â  Â  Â  zIndex="1000"
Â  Â  Â  shadow="md"
Â  Â  Â  initial="initial"
Â  Â  Â  animate="animate"
Â  Â  Â  variants={navbarVariants}
Â  Â  >
Â  Â  Â  <Flex h={16} alignItems={'center'} justifyContent={'space-between'} maxW="7xl" mx="auto">
Â  Â  Â  Â  
Â  Â  Â  Â  
Â  Â  Â  Â  <HStack 
Â  Â  Â  Â  Â  Â  spacing={8} 
Â  Â  Â  Â  Â  Â  alignItems={'center'}
Â  Â  Â  Â  Â  Â  w={{ base: 'auto', md: '200px' }} 
Â  Â  Â  Â  Â  Â  justifyContent={{ base: 'flex-start', md: 'flex-start' }}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <IconButton
Â  Â  Â  Â  Â  Â  size={'md'}
Â  Â  Â  Â  Â  Â  icon={isOpen ? <CloseIcon /> : <HamburgerIcon />}
Â  Â  Â  Â  Â  Â  aria-label={'Open Menu'}
Â  Â  Â  Â  Â  Â  display={{ md: 'none' }}
Â  Â  Â  Â  Â  Â  onClick={isOpen ? onClose : onOpen}
Â  Â  Â  Â  Â  Â  variant="ghost"
Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  {/* Replaced the previous Link/Text block with the logo Image */}
            <Link
Â  Â              as={RouterLink}
Â  Â              to="/"
Â  Â              _hover={{ textDecoration: 'none', opacity: 0.8 }} 
Â  Â              display="flex" 
Â  Â              alignItems="center"
            >
Â  Â              <ChakraImage // ðŸ‘ˆ FIX: Changed from Image to ChakraImage
Â  Â  Â  Â              src="/logo.jpg" // Path to the logo in the public folder
Â  Â  Â  Â              alt="PK Aluminium Welding Solutions Logo"
Â  Â  Â  Â              height={{ base: '30px', md: '40px' }} // Height for mobile and desktop
Â  Â  Â  Â              width="auto" // Maintain aspect ratio
Â  Â  Â  Â              objectFit="contain"
Â  Â              />
            </Link>
Â  Â  Â  Â  </HStack>

Â  Â  Â  Â  {/* Center: Desktop Navigation Links (NEW ALIGNMENT) */}
Â  Â  Â  Â  <HStack 
Â  Â  Â  Â  Â  Â  as={'nav'} 
Â  Â  Â  Â  Â  Â  spacing={4} 
Â  Â  Â  Â  Â  Â  display={{ base: 'none', md: 'flex' }} 
Â  Â  Â  Â  Â  Â  flex="1" 
Â  Â  Â  Â  Â  Â  justifyContent="center" 
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  {Links.map((link) => (
Â  Â  Â  Â  Â  Â  Â  Â  <NavLink key={link.to} to={link.to}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {link.label}
Â  Â  Â  Â  Â  Â  Â  Â  </NavLink>
Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  </HStack>

Â  Â  Â  Â  {/* Right Side: Call-to-Action Buttons */}
Â  Â  Â  Â  <Flex 
Â  Â  Â  Â  Â  Â  alignItems={'center'} 
Â  Â  Â  Â  Â  Â  gap={3}
Â  Â  Â  Â  Â  Â  w={{ base: 'auto', md: '200px' }} 
Â  Â  Â  Â  Â  Â  justifyContent={{ base: 'flex-end', md: 'flex-end' }}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  {/* Primary CTA (Call) - Minimalist Button */}
Â  Â  Â  Â  Â  <Button
Â  Â  Â  Â  Â  Â  as="a"
Â  Â  Â  Â  Â  Â  href={`tel:${COMPANY.phoneRaw}`}
Â  Â  Â  Â  Â  Â  variant="ghost"
Â  Â  Â  Â  Â  Â  size="md"
Â  Â  Â  Â  Â  Â  display={{ base: 'none', sm: 'flex' }}
Â  Â  Â  Â  Â  Â  leftIcon={<Icon as={FaPhoneAlt} w={4} h={4} color={accentColor} />}
Â  Â  Â  Â  Â  Â  color={accentColor}
Â  Â  Â  Â  Â  Â  _hover={{ bg: useColorModeValue('gray.100', 'gray.700'), transform: 'translateY(-1px)' }}
Â  Â  Â  Â  Â  />

Â  Â  Â  Â  Â  {/* Secondary CTA (Quote) - Highlighted Button */}
Â  Â  Â  Â  Â  <MotionButton
Â  Â  Â  Â  Â  Â  as={RouterLink}
Â  Â  Â  Â  Â  Â  to="/contact"
Â  Â  Â  Â  Â  Â  colorScheme="blue"
Â  Â  Â  Â  Â  Â  size="md"
Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.05, boxShadow: "0 4px 12px rgba(66, 153, 225, 0.5)" }}
Â  Â  Â  Â  Â  Â  transition={{ duration: 0.2 }}
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â Get a Quote
Â  Â  Â  Â  Â  </MotionButton>
Â  Â  Â  Â  </Flex>
Â  Â  Â  </Flex>

Â  Â  Â  {/* Mobile Menu (Animated Collapse) */}
Â  Â  Â  {isOpen ? (
Â  Â  Â  Â  <MotionBox
Â  Â  Â  Â  Â  pb={4}
Â  Â  Â  Â  Â  display={{ md: 'none' }}
Â  Â  Â  Â  Â  initial={{ opacity: 0, height: 0 }}
Â  Â  Â  Â  Â  animate={{ opacity: 1, height: 'auto' }}
Â  Â  Â  Â  Â  exit={{ opacity: 0, height: 0 }}
Â  Â  Â  Â  Â  transition={{ duration: 0.3 }}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <Stack as={'nav'} spacing={1}>
Â  Â  Â  Â  Â  Â  {Links.map((link) => (
Â  Â  Â  Â  Â  Â  Â  <NavLink key={link.to} to={link.to}>
Â  Â  Â  Â  Â  Â  Â  Â  {link.label}
Â  Â  Â  Â  Â  Â  Â  </NavLink>
Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  </Stack>
Â  Â  Â  Â  </MotionBox>
Â  Â  Â  ) : null}
Â  Â  </MotionBox>
Â  );
}